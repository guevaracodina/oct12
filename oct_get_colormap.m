function colormapOut = oct_get_colormap(map, varargin)
% Creates colormaps that are adequate to display images in SS-OCT system. Also
% creates maps adequate for photoacoustic tomography, OIS & NIRS, as well
% as infrared thermography.
% SYNTAX:
% colormapOut = oct_get_colormap(map, nColors)
% INPUTS:
% map           String that describes the colormap to retrieve:
%               'octgold'
%               'fdrainbow'
%               'tdrainbow'
%               'wob'
%               'bow'
%               'flow'
%               'rwbdoppler'
%               'bwrdoppler'
%               'robdoppler'
%               'bordoppler'
%               'redmap'
%               'greenmap'
%               'bluemap'
%               'kredmap'
%               'kgreenmap'
%               'kbluemap'
%               'purplemap'
%               'redbluecmap'
%               'so2'
%               'bipolar'
%               'warm'
%               'cold'
%               'linlhot'
%               'isol'
%               'cubicl'
%               'edge'
%               'cubicyf'
%               'linearl'
%               'iron'
%               'thermal'
%               'rainbowhc'
% nColors       Integer number of RGB triplets to be generated, default is
%               256 color levels
% OUTPUTS:
% colormapOut   3 columns matrix, which values are in the range from 0 to 1.
%_______________________________________________________________________________
% Copyright (C) 2013 LIOM Laboratoire d'Imagerie Optique et Moléculaire
%                    École Polytechnique de Montréal
% Edgar Guevara
% 2013/05/22
% ------------------------------------------------------------------------------
% Optional inputs handling
% ------------------------------------------------------------------------------
% only want 1 optional input at most
numvarargs                  = length(varargin);
if numvarargs > 1
    error('ioi_get_colormap', ...
        'Requires at most 2 optional inputs');
end
% set defaults for optional inputs
optargs                     = { 256 };
% now put these defaults into the optargs cell array, and overwrite the ones
% specified in varargin.
optargs(1:numvarargs)       = varargin;
% Place optional args in memorable variable names
ColorMapSize   = optargs{:};
% ------------------------------------------------------------------------------

ColorMapSize = fix(ColorMapSize/2);
% ColorMapSize = 256/2;

switch lower(map)
    case 'rainbowhc'
        % FLIR rainbow HC (High Contrast) LUT, obtaine from the FLIR Tools
        % software. A rainbow variant with 6 colors. Increased bands cover
        % large differences better, but it is excessive for limited ranges
        rgb = [0,0,0;0,0,0;0.0213847437219044,0,0.0182173798859143;0.0445287152801368,0,0.0440147750070121;0.0774800761564689,0,0.0799519473550545;0.101817774414331,0,0.101748730504691;0.139388821782822,0,0.138565505792711;0.165549213013245,0,0.161715596202803;0.195951955738045,0,0.195241291452307;0.226807213008276,0,0.223142301551650;0.249980880072347,0,0.251146018824307;0.285563639893525,0,0.284445310939436;0.308694778400069,0,0.307644530247416;0.344618192167324,0,0.344332693603209;0.372612197044423,0,0.365239336243657;0.408644718370239,0,0.408357389656643;0.468968762042830,0,0.469033619806527;0.471051983001741,0,0.471051983001741;0.494608722609025,0,0.494435862838455;0.517758415375859,0,0.520191804049774;0.555653634804392,0,0.555224375864703;0.581396492241386,0,0.578323913375549;0.614626017148211,0,0.613536911416215;0.642057000572732,0,0.638290475644419;0.670699368563469,0,0.670383412971691;0.699279952160866,0,0.699330511116023;0.726230825043339,0,0.726230825043339;0.749919781569755,0,0.749919781569755;0.786742387497557,0,0.786833970083151;0.814231373558575,0,0.813347107748472;0.845150084477989,0,0.842668256583493;0.870824093356249,6.52819659188567e-05,0.875076153138419;0.870699661221746,0.00332004217858040,0.891249297224006;0.871896170370840,0.00416767770003580,0.895184700537157;0.852895071914071,0.00153445709604083,0.884881140682346;0.816707727889141,0,0.873256434459671;0.793374761638341,0,0.866785557810331;0.759154904833867,0,0.854332282279974;0.732954587631565,0,0.845476808640775;0.702609548519635,0,0.834260400644485;0.671841780804580,0,0.823938098456577;0.646006671636385,0,0.814300336596638;0.611774084525359,0,0.805839772834172;0.583713701664850,0,0.795862978277339;0.549134031715323,0,0.783731930610894;0.526865869951803,0,0.776266125531961;0.490135231948678,0,0.762394158547046;0.465527360598353,0,0.755127027352172;0.409656860165977,0,0.735357886241738;0.404231618937634,0,0.733378596568371;0.377392184439307,0,0.725519588150495;0.353791426261723,0,0.716850778563503;0.319786896639053,0,0.704439532870598;0.291223479584624,0,0.695856595010292;0.257411249975801,0,0.684230356708079;0.230969235834786,0,0.674461057635577;0.200901402133483,0,0.667516120589242;0.169862435007619,0,0.653358988713804;0.144231960998899,0,0.646612218778353;0.109651668230989,0,0.633299772019134;0.0864773538562033,0,0.624869753058802;0.0509475046339645,0,0.613935342106381;0.0268031858456109,0,0.601986965509194;0.00144931391200567,0.00831131381920377,0.599863065540811;0,0.0643096049902040,0.622517670676314;0,0.0669422003925848,0.623719239960908;0,0.0934582140992143,0.626122124487252;0,0.115240818906917,0.632892710454437;0,0.150932221222579,0.647954517459024;0,0.176013550665613,0.657278708438985;0,0.205949143209707,0.664923938648978;0,0.233748565463528,0.671303246450925;0,0.262428893791980,0.682408014226831;0,0.294614901400153,0.696615191247566;0,0.322166410290339,0.706094074885783;0,0.355684867766757,0.718360035966396;0,0.380087339906307,0.725041844741598;0,0.405674082549925,0.731341222341058;0,0.436937949560780,0.743026792813984;0,0.467297764184786,0.753135510599381;0,0.522250503772535,0.769295440283713;0,0.533507282688611,0.772659351195175;0,0.550337571319888,0.776516718688429;0,0.586582044624649,0.789801054610576;0,0.610177177402043,0.801235377729911;0,0.642589037215035,0.816269544737335;0,0.667404797885624,0.824166340865436;0,0.703125922970771,0.828608874358571;0,0.728048146062153,0.838498829110451;0,0.756239390879221,0.851157591803440;0,0.788827271735962,0.864429809035737;0,0.813274034435654,0.868439983596631;0,0.848471087585844,0.876517577911098;0,0.873352499324462,0.887765680491969;0,0.892911351717566,0.889644264254175;0,0.871702797120809,0.858576795593811;0,0.835592862735696,0.806137718740146;0,0.831536835839226,0.800280616978568;0,0.815684530764039,0.776818916565013;0,0.796989251540836,0.739816246995127;0,0.781057057216397,0.714890186120407;0,0.755307233240656,0.679450035396260;0,0.741003114755575,0.656153925728671;0,0.725606254015284,0.631603699670036;0,0.702488229950924,0.601675410492323;0,0.681693446360034,0.570128486023698;0,0.667824514262318,0.547373292193573;0,0.642089828854639,0.511640510850252;0,0.624954292589069,0.489757252236120;0,0.604882914948690,0.455797248955102;0,0.590355135921241,0.423998519531815;0,0.568421169055877,0.390432981918238;0,0.527361647634846,0.332033821402689;0,0.525322707108370,0.329221394066141;0,0.511295086531122,0.306424470536524;0,0.494798885822455,0.283286102934320;0,0.469679291952603,0.247886065112161;0,0.453980937089305,0.223531496412789;0,0.433056503540456,0.191879748327923;0,0.414628451863115,0.166327352769895;0,0.400166250212465,0.131548744777874;0,0.379277617623723,0.101453271441319;0,0.358051362320441,0.0746951568696805;0,0.337981158329263,0.0407354172316833;0,0.322431926371696,0.0175772689174175;0.0147245596074948,0.316840159923774,0;0.0404238167976937,0.333297853886368,0;0.0586682336161494,0.348874146344597,0;0.110131875068153,0.384312245255650,0;0.121735181488278,0.392527191398069,0;0.138056322761605,0.399901243657232,0;0.171704344764336,0.424154815837101,0;0.195271490735423,0.441555490247311,0;0.227829788527407,0.461579555008791,0;0.246544413864988,0.476633484230804,0;0.279925600480121,0.494940117050543,0;0.311823492532713,0.512515757212264,0;0.331035301719009,0.528149629042548,0;0.363724825156181,0.551159271388069,0;0.387289928562382,0.566118653017854,0;0.420479132529581,0.586638549498111,0;0.441849132691380,0.601718407072603,0;0.470261046312656,0.623387906942158,0;0.497511935428094,0.637521414606140,0;0.549933281754709,0.673658636328125,0;0.557021979065707,0.678416149341907,0;0.571275062818517,0.690744358607124,0;0.606986985694266,0.714261390414197,0;0.633949913258515,0.729325294117830,0;0.665550272968976,0.749848712801838,0;0.684312811064607,0.764138790069748,0;0.717879901926833,0.784168557653081,0;0.741471531478205,0.804028734723969,0;0.766093683508813,0.815995933224445,0;0.787066872673339,0.832250337917716,0;0.820871500456997,0.854936909981821,0;0.843432313767110,0.868385923042014,0;0.874830101081581,0.890723178926807,0;0.898366880982219,0.905040109940950,0;0.880707393135970,0.870442680256049,0;0.856211557671095,0.814787284746750,0;0.854985190020240,0.811708300509999,0;0.840694136626313,0.789304560431596,0;0.827667630415833,0.766235489349677,0;0.815549311707638,0.730813200314189,0;0.807669278655406,0.707201174903288,0;0.788365756449898,0.678812204966212,0;0.775659845879753,0.653427699513114,0;0.762002897060428,0.625364387354781,0;0.750526404888409,0.592285932584907,0;0.739060385885038,0.570719183997199,0;0.722501009373648,0.539735512481234,0;0.713202841959686,0.515993809330531,0;0.699182888439857,0.480232957342952,0;0.688399302522122,0.459329797550082,0;0.674029634082727,0.429090117753518,0;0.651239463038514,0.377058713343050,0;0.650628400308709,0.375727370353328,0;0.638467621454403,0.351445046830374,0;0.626333945946236,0.327568123580533,0;0.616208022064201,0.303497427179498,0;0.602941052210903,0.269490084756586,0;0.590716651357077,0.248109114186669,0;0.575802478390789,0.219009440855743,0;0.558050895933012,0.190658626694631,0;0.551359714333136,0.162811888307746,0;0.534723187962458,0.132538092173770,0;0.522274840186522,0.111577514503961,0;0.505699512206017,0.0783796881451905,0;0.495369181713065,0.0548611095691428,0;0.482351996897345,0.0208233943977434,0;0.471380331727145,0,0.000529567967820003;0.498016809107495,0.0102406582132877,0.0137306712582266;0.502218220576618,0.0116722957700675,0.0159660240402533;0.506484534303950,0.0165690603832207,0.0152653677438394;0.520205661163899,0.0251890391924825,0.0234570591443018;0.529834224444044,0.0274169281084608,0.0290303524617775;0.543873668758506,0.0304442685676278,0.0346797801710868;0.554370090473536,0.0365632878336886,0.0392895688605198;0.563063275542122,0.0442007810654149,0.0410776914737484;0.576251080818348,0.0508951974341068,0.0507943658822255;0.589459895438927,0.0542878055066975,0.0574964733748937;0.605274896676469,0.0610221435148575,0.0653825463774505;0.611952232591580,0.0693915060892733,0.0687212143350060;0.624750544364769,0.0770558119821488,0.0751203702216005;0.636453488460243,0.0808574053383443,0.0809250902296576;0.648391794164403,0.0866361046126866,0.0872989432501656;0.663213943823966,0.0909052111289179,0.0974614302086115;0.681288254968318,0.101254211990227,0.101851825652761;0.682209658638003,0.101911026566778,0.101823492477634;0.693315922160607,0.107610078775019,0.107274470836569;0.705250386064747,0.111302957819623,0.115345205073026;0.717751484845731,0.119309481487284,0.121882193087716;0.724586959768605,0.127455210207665,0.122794922843037;0.740656991361046,0.134170662244752,0.131976525194724;0.753538376125573,0.137489220389884,0.141573848233935;0.767087019405672,0.144399383371440,0.148015689874707;0.779037921708594,0.152041197167641,0.148856387334128;0.785016741564780,0.155430797276323,0.153738311232416;0.798346171913986,0.159314011877083,0.162069392686844;0.809914143501182,0.163477783294889,0.167859896324501;0.823003608950666,0.171859790983138,0.172638188449258;0.829636585401475,0.176694167774611,0.172972233579010;0.844508470431990,0.192518413866093,0.192410072911948;0.854801342875836,0.238248733563870,0.238295408557193;0.854996019095093,0.239686883639115,0.239662689703390;0.857967777252046,0.257266858708355,0.254029179054350;0.860749267283599,0.279656616017861,0.275474586787300;0.867335903751837,0.308067233928042,0.306555194066293;0.871989326563607,0.327359188334764,0.326313476202236;0.874830614681361,0.350815023000192,0.347293155579074;0.878415916540986,0.369503767601101,0.372768902952608;0.881893918202153,0.397243208216011,0.401506383431757;0.887858602802770,0.419129928724432,0.417492747670713;0.893170118036835,0.447501072305595,0.443146141385559;0.895798475329394,0.464773550149591,0.462576360841584;0.899845104483917,0.493517250022905,0.493590438625217;0.903519253767712,0.514810197775344,0.515663031919480;0.910586541954141,0.539617545797835,0.542738661952403;0.913986473290558,0.566448965879004,0.566330516649122;0.920491311043186,0.612077537788744,0.608689172612165;0.921405104559777,0.619727051352151,0.615571277056972;0.926350758350038,0.633210429613251,0.631903068301682;0.932135199390704,0.663689766978546,0.661127132503323;0.934718599906793,0.682805050099107,0.680129472382396;0.938760213471546,0.710488268708217,0.710711914247385;0.942256143790999,0.733058340184046,0.732638660665272;0.949328313967502,0.756692897795574,0.752312126073441;0.952880449727951,0.783571382918111,0.775755419584676;0.956100091447159,0.803338150747476,0.798593266129914;0.959827999797633,0.833255694364338,0.829092589416870;0.964971662542456,0.849269425031407,0.849780844518544;0.971073132790848,0.876663115309968,0.878942643025091;0.973661413776940,0.898147594571967,0.895679318711342;0.977756081625152,0.926645512552531,0.919767025561526;0.980520971147800,0.945999739211066,0.942199095500981];
        x = round(linspace(1, ColorMapSize, size(rgb,1)));
    case 'thermal'
        % LUT from Fiji (ImageJ)
        rgb = [ 70	0	115
            70	0	115
            70	0	116
            70	0	118
            70	0	120
            70	0	122
            70	0	124
            70	0	126
            70	0	128
            70	0	131
            70	0	133
            70	0	136
            70	0	139
            70	0	141
            70	0	144
            70	0	147
            70	0	151
            70	0	154
            70	0	157
            70	0	160
            70	0	164
            70	0	167
            70	0	170
            70	0	174
            70	0	177
            70	0	181
            70	0	184
            70	0	188
            70	0	194
            70	0	200
            70	0	206
            70	0	211
            70	0	217
            70	0	222
            70	0	227
            70	0	232
            70	0	236
            70	0	240
            70	0	244
            69	0	248
            69	0	251
            68	0	253
            67	2	255
            66	5	255
            64	9	255
            63	13	255
            61	17	255
            59	22	255
            57	27	255
            55	32	255
            53	38	255
            51	44	255
            48	50	255
            45	57	255
            43	63	255
            40	70	255
            37	77	255
            34	84	255
            31	91	255
            28	98	255
            26	106	255
            23	113	254
            20	121	253
            17	128	252
            14	136	251
            12	144	250
            9	152	248
            6	160	247
            4	168	246
            2	176	245
            0	183	243
            0	191	242
            0	198	241
            0	205	240
            0	212	239
            0	218	238
            0	224	237
            0	230	236
            0	235	235
            0	240	235
            0	245	235
            0	249	234
            0	253	234
            1	255	234
            4	255	234
            7	255	234
            11	255	235
            16	255	236
            21	255	237
            27	255	238
            32	255	239
            39	255	240
            45	255	241
            52	255	243
            60	255	244
            68	255	246
            76	255	247
            84	255	249
            92	255	250
            101	255	252
            109	255	253
            117	255	254
            126	255	254
            134	255	254
            143	255	254
            152	255	254
            160	255	254
            168	255	254
            176	255	254
            184	255	254
            192	255	254
            199	255	254
            206	255	254
            213	255	254
            219	255	254
            225	255	254
            231	255	254
            236	255	254
            240	255	254
            244	255	254
            247	255	254
            250	255	254
            252	254	254
            253	254	254
            254	254	254
            254	254	252
            253	254	249
            252	254	246
            251	254	243
            249	254	239
            246	254	236
            243	254	231
            240	254	227
            237	254	223
            233	254	218
            228	254	213
            223	255	208
            219	255	203
            214	255	198
            208	255	192
            203	255	187
            196	255	181
            190	255	175
            184	255	169
            178	255	163
            171	255	157
            165	255	151
            158	255	145
            151	255	138
            144	255	132
            138	255	126
            129	255	118
            120	255	110
            112	255	102
            103	255	94
            95	255	87
            87	255	79
            79	255	72
            71	255	65
            64	255	58
            57	255	51
            51	255	45
            45	255	38
            39	255	32
            35	255	27
            30	255	22
            27	255	17
            24	255	13
            21	255	8
            20	255	5
            19	255	2
            19	255	1
            21	255	1
            23	255	1
            27	255	1
            32	255	1
            37	255	1
            44	255	1
            51	255	1
            59	255	1
            68	255	1
            77	255	1
            86	255	1
            97	255	3
            107	255	5
            118	255	8
            125	255	10
            131	255	12
            137	255	14
            144	255	16
            150	255	17
            156	255	19
            162	255	21
            168	255	23
            174	255	25
            180	255	26
            185	255	28
            191	255	30
            197	254	31
            202	254	33
            207	252	34
            212	252	36
            217	250	37
            222	249	38
            227	248	39
            231	246	40
            235	245	41
            238	243	42
            242	241	43
            245	239	43
            248	237	43
            251	235	44
            253	233	44
            255	229	44
            255	226	44
            255	222	43
            255	218	43
            255	213	42
            255	208	42
            255	203	41
            255	198	40
            255	192	40
            255	187	39
            255	181	38
            255	175	37
            255	169	36
            255	162	34
            255	156	33
            255	149	32
            255	143	31
            255	136	30
            255	129	28
            255	122	27
            255	116	25
            255	109	24
            255	102	23
            255	95	21
            255	89	20
            255	82	19
            255	76	17
            255	70	16
            255	63	15
            255	57	13
            255	51	12
            255	45	11
            255	40	10
            255	35	9
            255	29	7
            255	25	6
            255	20	6
            255	16	5
            255	12	4
            255	8	3
            255	5	3
            255	2	2
            255	2	2]/255;
        x = round(linspace(1, ColorMapSize, size(rgb,1)));
    case 'iron'
        % Evernote: Infrared camera/ Thermographic camera pseudo colormap
        % Link: https://www.evernote.com/shard/s82/nl/9016199/b73314ad-af9d-442d-b324-d8a278ade985
        % Palette with 7 special shades and 120 shades in temp scale
        %         rgb = [ 0/255         0/255            0/255;   % 0, 0, 0
        %             00/255            0/255            45/255;  % 0, 0, 36
        %             05/255            0/255            60/255;  % 0, 0, 51
        %             08/255            0/255            70/255;  % 0, 0, 66
        %             11/255            0/255            85/255;  % 0, 0, 81
        %             14/255            0/255            92/255;  % 2, 0, 90
        %             17/255            0/255            99/255;  % 4, 0, 99
        %             20/255            0/255            106/255; % 7, 0, 106
        %             23/255            0/255            115/255; % 11, 0, 115
        %             27/255            0/255            119/255; % 14
        %             30/255            0/255            123/255; % 20
        %             33/255            0/255            128/255; % 27
        %             37/255            0/255            133/255; % 33
        %             43/255            0/255            137/255; % 41
        %             48/255            0/255            140/255;
        %             55/255            0/255            143/255;
        %             61/255            0/255            146/255;
        %             66/255            0/255            149/255;
        %             72/255            0/255            150/255;
        %             78/255            0/255            151/255;
        %             84/255            0/255            152/255;
        %             91/255            0/255            153/255;
        %             97/255            0/255            155/255;
        %             104/255            0/255            155/255;
        %             110/255            0/255            156/255;
        %             115/255            0/255            157/255;
        %             122/255            0/255            157/255;
        %             128/255            0/255            157/255;
        %             134/255            0/255            157/255;
        %             139/255            0/255            157/255;
        %             146/255            0/255            156/255;
        %             152/255            0/255            155/255;
        %             157/255            0/255            155/255;
        %             162/255            0/255            155/255;
        %             167/255            0/255            154/255;
        %             171/255            0/255            153/255;
        %             175/255            1/255            152/255;
        %             178/255            1/255            151/255;
        %             182/255            2/255            149/255;
        %             185/255            4/255            149/255;
        %             188/255            5/255            147/255;
        %             191/255            6/255            146/255;
        %             193/255            8/255            144/255;
        %             195/255            11/255            142/255;
        %             198/255            13/255            139/255;
        %             201/255            17/255            135/255;
        %             203/255            20/255            132/255;
        %             206/255            23/255            127/255;
        %             208/255            26/255            121/255;
        %             210/255            29/255            116/255;
        %             212/255            33/255            111/255;
        %             214/255            37/255            103/255;
        %             217/255            41/255            97/255;
        %             219/255            46/255            89/255;
        %             221/255            49/255            78/255;
        %             223/255            53/255            66/255;
        %             224/255            56/255            54/255;
        %             226/255            60/255            42/255;
        %             228/255            64/255            30/255;
        %             229/255            68/255            25/255;
        %             231/255            72/255            20/255;
        %             232/255            76/255            16/255;
        %             234/255            78/255            12/255;
        %             235/255            82/255            10/255;
        %             236/255            86/255            8/255;
        %             237/255            90/255            7/255;
        %             238/255            93/255            5/255;
        %             239/255            96/255            4/255;
        %             240/255            100/255            3/255;
        %             241/255            103/255            3/255;
        %             241/255            106/255            2/255;
        %             242/255            109/255            1/255;
        %             243/255            113/255            1/255;
        %             244/255            116/255            0/255;
        %             244/255            120/255            0/255;
        %             245/255            125/255            0/255;
        %             246/255            129/255            0/255;
        %             247/255            133/255            0/255;
        %             248/255            136/255            0/255;
        %             248/255            139/255            0/255;
        %             249/255            142/255            0/255;
        %             249/255            145/255            0/255;
        %             250/255            149/255            0/255;
        %             251/255            154/255            0/255;
        %             252/255            159/255            0/255;
        %             253/255            163/255            0/255;
        %             253/255            168/255            0/255;
        %             253/255            172/255            0/255;
        %             254/255            176/255            0/255;
        %             254/255            179/255            0/255;
        %             254/255            184/255            0/255;
        %             254/255            187/255            0/255;
        %             254/255            191/255            0/255;
        %             254/255            195/255            0/255;
        %             254/255            199/255            0/255;
        %             254/255            202/255            1/255;
        %             254/255            205/255            2/255;
        %             254/255            208/255            5/255;
        %             254/255            212/255            9/255;
        %             254/255            216/255            12/255;
        %             255/255            219/255            15/255;
        %             255/255            221/255            23/255;
        %             255/255            224/255            32/255;
        %             255/255            227/255            39/255;
        %             255/255            229/255            50/255;
        %             255/255            232/255            63/255;
        %             255/255            235/255            75/255;
        %             255/255            238/255            88/255;
        %             255/255            239/255            102/255;
        %             255/255            241/255            116/255;
        %             255/255            242/255            134/255;
        %             255/255            244/255            149/255;
        %             255/255            245/255            164/255;
        %             255/255            247/255            179/255;
        %             255/255            248/255            192/255;
        %             255/255            249/255            203/255;
        %             255/255            251/255            216/255;
        %             255/255            253/255            228/255;
        %             255/255            254/255            239/255;
        %             255/255            255/255            249/255];
        rgb = [ 0, 0, 0
            0, 0, 36
            0, 0, 51
            0, 0, 66
            0, 0, 81
            2, 0, 90
            4, 0, 99
            7, 0, 106
            11, 0, 115
            14, 0, 119
            20, 0, 123
            27, 0, 128
            33, 0, 133
            41, 0, 137
            48, 0, 140
            55, 0, 143
            61, 0, 146
            66, 0, 149
            72, 0, 150
            78, 0, 151
            84, 0, 152
            91, 0, 153
            97, 0, 155
            104, 0, 155
            110, 0, 156
            115, 0, 157
            122, 0, 157
            128, 0, 157
            134, 0, 157
            139, 0, 157
            146, 0, 156
            152, 0, 155
            157, 0, 155
            162, 0, 155
            167, 0, 154
            171, 0, 153
            175, 1, 152
            178, 1, 151
            182, 2, 149
            185, 4, 149
            188, 5, 147
            191, 6, 146
            193, 8, 144
            195, 11, 142
            198, 13, 139
            201, 17, 135
            203, 20, 132
            206, 23, 127
            208, 26, 121
            210, 29, 116
            212, 33, 111
            214, 37, 103
            217, 41, 97
            219, 46, 89
            221, 49, 78
            223, 53, 66
            224, 56, 54
            226, 60, 42
            228, 64, 30
            229, 68, 25
            231, 72, 20
            232, 76, 16
            234, 78, 12
            235, 82, 10
            236, 86, 8
            237, 90, 7
            238, 93, 5
            239, 96, 4
            240, 100, 3
            241, 103, 3
            241, 106, 2
            242, 109, 1
            243, 113, 1
            244, 116, 0
            244, 120, 0
            245, 125, 0
            246, 129, 0
            247, 133, 0
            248, 136, 0
            248, 139, 0
            249, 142, 0
            249, 145, 0
            250, 149, 0
            251, 154, 0
            252, 159, 0
            253, 163, 0
            253, 168, 0
            253, 172, 0
            254, 176, 0
            254, 179, 0
            254, 184, 0
            254, 187, 0
            254, 191, 0
            254, 195, 0
            254, 199, 0
            254, 202, 1
            254, 205, 2
            254, 208, 5
            254, 212, 9
            254, 216, 12
            255, 219, 15
            255, 221, 23
            255, 224, 32
            255, 227, 39
            255, 229, 50
            255, 232, 63
            255, 235, 75
            255, 238, 88
            255, 239, 102
            255, 241, 116
            255, 242, 134
            255, 244, 149
            255, 245, 164
            255, 247, 179
            255, 248, 192
            255, 249, 203
            255, 251, 216
            255, 253, 228
            255, 254, 239
            255, 255, 249 ]/255;
        x = round(linspace(1, ColorMapSize, size(rgb,1)));
    case 'octgold'
        % OCT Gold: typical high contrast, high dynamic OCT map
        x = [0 7 60 108 157 190 224 253 254 255] + 1;
        rgb = [ ...
            0.00392157  0.00392157  0.0156863;
            0.0352941   0           0;
            0.376471    0.105882    0;
            0.678431    0.337255    0;
            0.992157    0.701961    0.203922;
            0.992157    0.878431    0.341176;
            0.996078    0.996078    0.482353;
            0.94902     0.996078    0.603922;
            0.905882    0.952941    0.607843;
            0.905882    0.952941    0.607843];
    case 'fdrainbow'
        % Fourier-Domain Rainbow: multi-colour, high dynamic range colour map for
        % novel OCT systems
        x = [0 22 53 68 106 141 168 194 245 255] + 1;
        rgb = [ ...
            0.00392157  0.00392157  0.0156863;
            0.0313725   0.0313725   0.117647;
            0.00392157  0.113725    0.541176;
            0.203922    0.486275    0.207843;
            0.294118    0.780392    0.145098;
            0.847059    0.752941    0.435294;
            1           0.966912    0.0735296;
            0.992157    0.792157    0.411765;
            1           0.3         0.3;
            1           0.984314    0.984314];
    case 'tdrainbow'
        % Time-Domain Rainbow: mimicking the old time domain high dynamic range
        % colour map found in the commercial devices
        x = [32 64 78 138 221 255] + 1;
        rgb = [ ...
            0.00392157  0.00392157  0.0156863;
            0.3         0.3         1;
            0.176471    0.760784    0.254902;
            1           1           0.301961;
            1           0.3         0.3;
            1           0.984314    0.984314];
    case 'wob'
        % grey-scale with transparency for frequency domain OCT data
        x = [0 40 72 136 255] + 1;
        rgb = [...
            0.00392157  0.00392157  0.0156863;
            0           0           0;
            0.301961    0.301961    0.301961;
            0.733333    0.733333    0.733333;
            1           1           1];
    case 'bow'
        % grey-scale with transparency for frequency domain OCT data (not very
        % commonly used by the community, but good for faint signals)
        x = [0 35 96 148 255] + 1;
        rgb = [...
            1           1           1;
            0.890196    0.890196    0.890196;
            0.584314    0.584314    0.584314;
            0.282353    0.282353    0.282353;
            0           0           0];
    case 'flow'
        % High flow velocity contrast 20kHz
        x = [0 69 128 184 255] + 1;
        rgb = [...
            0.133333    0.188235    1;
            0.301961    0.760784    1;
            0.286275    0.913725    0.27451;
            0.972549    1           0.0862745;
            1           0.1         0.1];
    case 'purplemap'
        % Single color luminance changes from purple to white
        x = [0 255] + 1;
        rgb = [...
            0.3412      0           0.4980;
            1           1           1];
    case 'rwbdoppler'
        % Red on blue, with white background for Doppler imaging
        % Also for SO2 contrast in photoacosutics
        minColor    = [0 0 1]; % blue
        medianColor = [1 1 1]; % white
        maxColor    = [1 0 0]; % red
        
        int1 = zeros(ColorMapSize,3);
        int2 = zeros(ColorMapSize,3);
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'bwrdoppler'
        % Blue on red, with white background for Doppler imaging
        minColor    = [1 0 0]; % red
        medianColor = [1 1 1]; % white
        maxColor    = [0 0 1]; % blue
        
        int1 = zeros(ColorMapSize,3);
        int2 = zeros(ColorMapSize,3);
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'robdoppler'
        % Red on blue, with black background for Doppler imaging
        minColor    = [0 0 1]; % blue
        medianColor = [0 0 0]; % white
        maxColor    = [1 0 0]; % red
        
        int1 = zeros(ColorMapSize,3);
        int2 = zeros(ColorMapSize,3);
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'bordoppler'
        % Blue on red, with black background for Doppler imaging
        minColor    = [1 0 0]; % red
        medianColor = [0 0 0]; % black
        maxColor    = [0 0 1]; % blue
        
        int1 = zeros(ColorMapSize,3);
        int2 = zeros(ColorMapSize,3);
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'so2'
        % Red on blue, sO2 PAT imaging
        minColor    = [0 0 1]; % blue
        medianColor = [0.5 0 0.5]; % ??
        maxColor    = [1 0 0]; % red
        
        int1 = zeros(ColorMapSize,3);
        int2 = zeros(ColorMapSize,3);
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'redbluecmap'
        % red represents values above the mean, white represents the mean, and
        % blue represents values below the mean
        colormapOut = redbluecmap;
        return
    case 'redmap'
        % Red map for HbT contrast in PAT, from VisualSonics
        minColor    = [0 0 0]; % black
        medianColor = [1 0 0]; % red
        maxColor    = [1 1 1]; % white
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'greenmap'
        % Green map
        minColor    = [0 0 0]; % black
        medianColor = [0 1 0]; % green
        maxColor    = [1 1 1]; % white
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'bluemap'
        % Blue map
        minColor    = [0 0 0]; % black
        medianColor = [0 0 1]; % blue
        maxColor    = [1 1 1]; % white
        for k=1:3
            int1(:,k) = linspace(minColor(k), medianColor(k), ColorMapSize);
            int2(:,k) = linspace(medianColor(k), maxColor(k), ColorMapSize);
        end
        colormapOut = [int1(1:end-1,:); int2];
        return
    case 'kredmap'
        % % Single color luminance changes from black to red
        x = [0 255] + 1;
        rgb = [...
            0           0           0;
            1           0           0];
    case 'kgreenmap'
        % % Single color luminance changes from black to green
        x = [0 255] + 1;
        rgb = [...
            0           0           0;
            0           1           0];
    case 'kbluemap'
        % % Single color luminance changes from black to blue
        x = [0 255] + 1;
        rgb = [...
            0           0           0;
            0           0           1];
    case 'bipolar'
        colormapOut = bipolar(2*ColorMapSize, 1/3);
        return
    case 'warm'
        colormapOut = bipolar(4*ColorMapSize, 1/3);
        colormapOut = colormapOut((end/2)+1:end,:);
        return
    case 'cold'
        colormapOut = bipolar(4*ColorMapSize, 1/3);
        colormapOut = colormapOut(1:(end/2),:);
        return
    case {'linlhot' 'isol' 'cubicl' 'edge' 'cubicyf' 'linearl'}
        % perceptually balanced colormaps
        colormapOut = pmkmp(2*ColorMapSize, map);
        return
    otherwise
        % Inverted linear gray colormap
        colormapOut = flipud(colormap(gray(2*ColorMapSize)));
        return
end

%% Calculate colormap
% ----------------------- Piecewise linear interpolation -----------------------
nSegments           = numel(x) - 1;
samplesPerSegment   = diff(x);
colormapOut         = zeros([sum(samplesPerSegment) 3]);

for iSegments = 1:nSegments,
    for iColors = 1:3,
        colormapOut(x(iSegments):x(iSegments+1),iColors) = linspace(rgb(iSegments,iColors),...
            rgb(iSegments+1,iColors),...
            samplesPerSegment(iSegments)+1);
    end
end

% --------------- uint8 array to export colormaps to LabView -------------------
% colormapOut = uint8(round(colormapOut*255));
% figure; plot(colormapOut)

% ---------------------------- Spline interpolation ----------------------------
% colormapOut(:,1) = spline(x, rgb(:,1), (x(1):x(end))');
% colormapOut(:,2) = spline(x, rgb(:,2), (x(1):x(end))');
% colormapOut(:,3) = spline(x, rgb(:,3), (x(1):x(end))');
% colormapOut(colormapOut<0) = 0;         % Get rid of negative numbers
% colormapOut(colormapOut>1) = 1;         % Truncate to 1
% figure; plot(colormapOut)

%% OCT Gold Alpha channel
% x                   = [0; 22; 70; 123; 251] + 1;
% alphaValues         = [0; 0; 0.0543478; 0.717391; 1];
% nPoints             = numel(x);
% nSegments           = nPoints - 1;
% samplesPerSegment   = diff(x);
% OCTgoldAlphaMap     = zeros([sum(samplesPerSegment) 1]);
%
% for iSegments = 1:nSegments,
%     OCTgoldAlphaMap(x(iSegments):x(iSegments+1)) = linspace(alphaValues(iSegments),...
%         alphaValues(iSegments+1),...
%         samplesPerSegment(iSegments)+1);
% end

% ==============================================================================

function cm = bipolar(m, n, interp)
%bipolar: symmetric/diverging/bipolar colormap, with neutral central color.
%
% Usage: cm = bipolar(m, neutral, interp)
%  neutral is the gray value for the middle of the colormap, default 1/3.
%  m is the number of rows in the colormap, defaulting to copy the current
%    colormap, or the colormap that MATLAB defaults for new figures.
%  interp is the method used to interpolate the colors, see interp1.
%
% The colormap goes from cyan-blue-neutral-red-yellow if neutral is < 0.5
% (the default) and from blue-cyan-neutral-yellow-red if neutral > 0.5.
%
% If neutral is exactly 0.5, then a map which yields a linear increase in
% intensity when converted to grayscale is produced (as derived in
% colormap_investigation.m). This colormap should also be reasonably good
% for colorblind viewers, as it avoids green and is predominantly based on
% the purple-yellow pairing which is easily discriminated by the two common
% types of colorblindness. For more details on this, see Brewer (1996):
% http://www.ingentaconnect.com/content/maney/caj/1996/00000033/00000002/art00002
%
% Examples:
%  surf(peaks)
%  cmx = max(abs(get(gca, 'CLim')));
%  set(gca, 'CLim', [-cmx cmx]);
%  colormap(bipolar)
%
%  imagesc(linspace(-1, 1,201)) % symmetric data, if not set symmetric CLim
%  colormap(bipolar(201, 0.1)) % dark gray as neutral
%  axis off; colorbar
%  pause(2)
%  colormap(bipolar(201, 0.9)) % light gray as neutral
%  pause(2)
%  colormap(bipolar(201, 0.5)) % grayscale-friendly colormap
%
% See also: colormap, jet, interp1, colormap_investigation, dusk
% dusk is a colormap like bipolar(m, 0.5), in Oliver Woodford's real2rgb:
%  http://www.mathworks.com/matlabcentral/fileexchange/23342
%
% Copyright 2009 Ged Ridgway at gmail com
% Based on Manja Lehmann's hand-crafted colormap for cortical visualisation

if ~exist('interp', 'var')
    interp = [];
end

if ~exist('n', 'var') || isempty(n)
    n = 1/3;
end

if ~exist('m', 'var') || isempty(m)
    if isempty(get(0, 'CurrentFigure'))
        m = get(0, 'DefaultFigureColormap');
    else
        m = get(gcf, 'Colormap');
    end
    m = size(m, 1);
end

if n < 0
    % undocumented rainbow-variant colormap, not recommended, as explained
    % by Borland & Taylor (2007) in IEEE Computer Graphics & Applications,
    % http://doi.ieeecomputersociety.org/10.1109/10.1109/MCG.2007.46
    if isempty(interp)
        interp = 'cubic'; % linear produces bands at pure green and yellow
    end
    n = abs(n);
    cm = [
        0 0 1
        0 1 0
        n n n
        1 1 0
        1 0 0
        ];
elseif n < 0.5
    if isempty(interp)
        interp = 'linear'; % seems to work well with dark neutral colors
    end
    cm = [
        0 1 1
        0 0 1
        n n n
        1 0 0
        1 1 0
        ];
elseif n > 0.5
    if isempty(interp)
        interp = 'cubic'; % seems to work better with bright neutral colors
    end
    cm = [
        0 0 1
        0 1 1
        n n n
        1 1 0
        1 0 0
        ];
else % exactly 0.5, use the brew2 scheme from colormap_investigation
    if isempty(interp)
        interp = 'linear';
    end
    if ~strcmp(interp, 'linear')
        warning('bipolar:nonlinearluminance', ...
            'Nonlinear interpolation will not preserve linear luminance!')
    end
    cm = [
        0.2157         0    0.3207
        0.0291    0.3072    1.0000
        0.5000    0.5000    0.5000
        1.0000    0.6035    0.3992
        0.9944    0.9891    0.1647
        ];
end

if m ~= size(cm, 1)
    xi = linspace(1, size(cm, 1), m);
    cm = interp1(cm, xi, interp);
end

function map=pmkmp(n,scheme)
% PMKMP Returns perceptually balanced colormaps with rainbow-like colors
%   PMKMP(N,SCHEME) returns an Nx3 colormap.
%   usage: map=pmkmp(n,scheme);
%
% JUSTIFICATION: rainbow, or spectrum color schemes are considered a poor
% choice for scientific data display by many in the scientific community
% (see for example reference 1 and 2) in that they introduce artifacts
% that mislead the viewer. "The rainbow color map appears as if its separated
% into bands of almost constant hue, with sharp transitions between hues.
% Viewers perceive these sharp transitions as sharp transitions in the data,
% even when this is not the casein how regularly spaced (interval) data are
% displayed (quoted from reference 1). This submission is intended to share
% the results of my work to create more perceptually balanced,
% rainbow-like color maps. Please see output arguments section for descriptions.
%
%
%   arguments: (input)
%   scheme - can be one of the following strings:
%     'IsoL'      Lab-based isoluminant rainbow with constant luminance L*=60
%                  For interval data displayed with external lighting
%
%     'LinearL'	  Lab-based linear lightness rainbow.
%                  For interval data displayed without external lighting
%                  100% perceptual
%
%     'LinLhot'	  Linear lightness modification of Matlab's hot color palette.
%                  For interval data displayed without external lighting
%                  100% perceptual
%
%     'CubicYF'	   Lab-based rainbow scheme with cubic-law luminance(default)
%                  For interval data displayed without external lighting
%                  100% perceptual
%
%     'CubicL'	   Lab-based rainbow scheme with cubic-law luminance
%                  For interval data displayed without external lighting
%                  As above but has red at high end (a modest deviation from
%                  100% perceptual)
%
%     'Edge'       Diverging Black-blue-cyan-white-yellow-red-black scheme
%                  For ratio data (ordered, constant scale, natural zero)
%
%   n - scalar specifying number of points in the colorbar. Maximum n=256
%      If n is not specified, the size of the colormap is determined by the
%      current figure. If no figure exists, MATLAB creates one.
%
%
%   arguments: (output)
%   map - colormap of the chosen scheme
%   - IsoL is based on work in paper 2 in the reference section.
%     In both this paper and in several others this is indicated as the
%     best for displaying interval data with external lighting.
%     This is so as to allow the lighting to provide the shading to
%     highlight the details of interest. If lighting is combined with a
%     colormap that has its own luminance function associated - even as
%     simple as a linear increase this will confuse the viewer. The only
%     difference from the paper is that I changed the value of constant
%     luminance to L*=60 to make it brighter that the authors' example.
%
%   - LinearL is a linear lightness modification of another palette from
%     paper 2 in the reference. For how it was generated see my blog post:
%     mycarta.wordpress.com/2012/12/06/the-rainbow-is-deadlong-live-the-rainbow-part-5-cie-lab-linear-l-rainbow/
%
%   - LinLhot is a linear lightness modification of Matlab's hot
%     color palette. For how it was generated see my blog post:
%     mycarta.wordpress.com/2012/10/14/the-rainbow-is-deadlong-live-the-rainbow-part-4-cie-lab-heated-body/
%
%   - CubicL too is based on some of the ideas in paper 2 in the
%      reference section but rather than using a linearly increasing
%      L* function such as the one used by those authors, I am
%      using a compressive or cubic law function for the increase in
%      L*.  L* ranges between 31 and 90 in the violet to yellowish
%      portion of the colormap, then decreases to about 80 to get
%      to the red (please refer to figure L_a_b_PlotsCubicL.png).
%      The choice to start at 31 was a matter of taste.
%      I like having violet instead of black at the cold end of the
%      colormap. The latter choice was so as to have red and not
%      white at the warm end  of the colorbar, which is also a
%      matter of personal taste. As a result,  there is an inversion in
%      the L* trend, but I believe because it is a smooth one that
%      this is an acceptable compromise and the resulting
%      colormap is much of an improvement over the standard
%      rainbow or spectrum schemes, which  typically have at least 3 sharp
%      L* inversions. Please run CompareLabPlotsUsingColorspace.m or see
%      figures: L_plot_for_CubicL_colormap.png, L_plot_for_jet_colormap.png,
%      and L_plot_for_spectrum_colormap.png for a demonstration
%
%    - CubicYF A fully perceptual version of the above in which I eliminated
%      the red tip at the high end. The work is described in papers 12 and 13.
%      I've uploaded 2 figures. The first, spectrum vs cubicYF.png, is a comparison
%      of lightness versus sample number for the spectrum (top left) and the
%      new color palette (bottom left), and also a comparison of test surface
%      (again the Great Pyramid of Giza)using the spectrum (top right)and
%      the new color palette (bottom right). The second figure
%      simulations color vision deficieny.png
%      is a comparison of spectrum and cubicYF rainbow for all viewers.
%      Left column: full color vision  for the spectrum (top left) and for the
%      cubeYF rainbow (bottom left). Centre column: simulation of Deuternaopia
%      for spectrum (top centre) and cubeYF rainbow (bottom centre).
%      Right column: simulation of Tritanopia for spectrum (top right) and
%      cubeYF rainbow (bottom right). For the cubeYF there are no
%      confusing color pairs in these simulations. There are several in the
%      spectrum. Please refer to reference 14 for vcolor vision deficiency
%      terminoligy. For how it was generated see my blog post:
%      http://mycarta.wordpress.com/2013/02/21/perceptual-rainbow-palette-the-method/
%
%
%   - Edge is based on the Goethe Edge Colors described in the book in
%     reference 3. In practice the colormap resembles a cold color map attached
%     to a warm color map. But the science behind it is rigorous and the
%     experimental work is based on is very intriguing to me: an alternative
%     to the Newtonian spectrum. This is not perceptually balanced in a
%     strict sense but because it does not have green it is perceptually
%     improved in a harmonious sense (refer to paper reference 10 for a review
%     of the concept of harmony in color visualization).
%
%
%
%   Example: 128-color rainbow with cubic-law luminance (default)
%     %  load mandrill;
%     %  imagesc(X);
%     %  colormap(pmkmp(128));
%     %  colorbar;
%   See files examples.m, examples1.m, and example2.m for more examples
%   See files MakeLabPlotUsingColorspace.m and CompareLabPlotsUsingColorspace.m
%   for some demonstrations
%
%
%   See also: JET, HSV, GRAY, HOT, COOL, BONE, COPPER, PINK, FLAG, PRISM,
%             COLORMAP, RGBPLOT
%
%
%   Other submissions of interest
%
%     Haxby color map
%     www.mathworks.com/matlabcentral/fileexchange/25690-haxby-color-map
%
%     Colormap and colorbar utilities
%     www.mathworks.com/matlabcentral/fileexchange/24371-colormap-and-color
%     bar-utilities-sep-2009
%
%     Lutbar
%     www.mathworks.com/matlabcentral/fileexchange/9137-lutbar-a-pedestrian-colormap-toolbarcontextmenu-creator
%
%     usercolormap
%     www.mathworks.com/matlabcentral/fileexchange/7144-usercolormap
%
%     freezeColors
%     www.mathworks.com/matlabcentral/fileexchange/7943
%
%
%     Bipolar Colormap
%     www.mathworks.com/matlabcentral/fileexchange/26026
%
%     colorGray
%     www.mathworks.com/matlabcentral/fileexchange/12804-colorgray
%
%     mrgb2gray
%     www.mathworks.com/matlabcentral/fileexchange/5855-mrgb2gray
%
%     CMRmap
%     www.mathworks.com/matlabcentral/fileexchange/2662-cmrmap-m
%
%     real2rgb & colormaps
%     www.mathworks.com/matlabcentral/fileexchange/23342-real2rgb-colormaps
%
%   Acknowledgements
%
%     For input to do this research I was inspired by:
%     ColorSpiral - http://bsp.pdx.edu/Software/ColorSpiral.m
%     Despite an erroneous assumption about conversion/equivalence to
%     grayscale (which CMRmap achieves correctly) the main idea is ingenious
%     and the code is well written. It also got me interested in perceptual
%     colormaps. See reference 5 for paper
%
%     For function architecture and code syntax I was inspired by:
%     Light Bartlein Color Maps
%     www.mathworks.com/matlabcentral/fileexchange/17555
%     (and comments posted therein)
%
%     For idea on world topgraphy in examples.m I was inspired by:
%     Cold color map
%     www.mathworks.cn/matlabcentral/fileexchange/23865-cold-colormap
%
%     To generate the spectrum in examples1.m I used:
%     Spectral and XYZ Color Functions
%     www.mathworks.com/matlabcentral/fileexchange/7021-spectral-and-xyz-color-functions
%
%     For Lab=>RGB conversions I used:
%     Colorspace transforamtions
%     www.mathworks.com/matlabcentral/fileexchange/28790-colorspace-transformations
%
%
%     For the figures in example 2 I used:
%     Shaded pseudo color
%     http://www.mathworks.cn/matlabcentral/fileexchange/14157-shaded-pseudo-color
%
%     For plots in CompareLabPlotsUsingColorspace.m I used:
%     cline
%     http://www.mathworks.cn/matlabcentral/fileexchange/14677-cline
%
%     For some ideas in general on working in Lab space:
%     Color scale
%     www.mathworks.com/matlabcentral/fileexchange/11037
%     http://blogs.mathworks.com/steve/2006/05/09/a-lab-based-uniform-color-scale/
%
%     A great way to learn more about improved colormaps and making colormaps:
%     MakeColorMap
%     www.mathworks.com/matlabcentral/fileexchange/17552
%     blogs.mathworks.com/videos/2007/11/15/practical-example-algorithm-development-for-making-colormaps/
%
%
%  References
%
%     1)  Borland, D. and Taylor, R. M. II (2007) - Rainbow Color Map (Still)
%         Considered Harmful
%         IEEE Computer Graphics and Applications, Volume 27, Issue 2
%         Pdf paper included in submission
%
%     2)  Kindlmann, G. Reinhard, E. and Creem, S. Face-based Luminance Matching
%         for Perceptual Colormap Generation
%         IEEE - Proceedings of the conference on Visualization '02
%         www.cs.utah.edu/~gk/papers/vis02/FaceLumin.pdf
%
%     3)  Koenderink, J. J. (2010) - Color for the Sciences
%         MIT press, Cambridge, Massachusset
%
%     4)  Light, A. and Bartlein, P.J. (2004) - The end of the rainbow?
%         Color schemes for improved data graphics.
%         EOS Transactions of the American Geophysical Union 85 (40)
%         Reprint of Article with Comments and Reply
%         http://geography.uoregon.edu/datagraphics/EOS/Light-and-Bartlein.pdf
%
%     5)  McNames, J. (2006) An effective color scale for simultaneous color
%         and gray-scale publications
%         IEEE Signal Processing Magazine, Volume 23, Issue1
%         http://bsp.pdx.edu/Publications/2006/SPM_McNames.pdf
%
%     6)  Rheingans, P.L. (2000), Task-based Color Scale Design
%         28th AIPR Workshop: 3D Visualization for Data Exploration and Decision Making
%         www.cs.umbc.edu/~rheingan/pubs/scales.pdf.gz
%
%     7)  Rogowitz, B.E. and  Kalvin, A.D. (2001) - The "Which Blair project":
%         a quick visual method for evaluating perceptual color maps.
%         IEEE - Proceedings of the conference on Visualization 01
%         www.research.ibm.com/visualanalysis/papers/WhichBlair-Viz01Rogowitz_Kalvin._final.pdf
%
%     8)  Rogowitz, B.E. and  Kalvin, A.D. - Why Should Engineers and Scientists
%         Be Worried About Color?
%         www.research.ibm.com/people/l/lloydt/color/color.HTM
%
%     9)  Rogowitz, B.E. and  Kalvin, A.D. - How NOT to Lie with Visualization
%         www.research.ibm.com/dx/proceedings/pravda/truevis.htm
%
%     10) Wang, L. and Mueller,K (2008) - Harmonic Colormaps for Volume Visualization
%         IEEE/ EG Symposium on Volume and Point-Based Graphics
%         http://www.cs.sunysb.edu/~mueller/papers/vg08_final.pdf
%
%     11) Wyszecki, G. and Stiles W. S. (2000) - Color Science: Concepts and
%         Methods, Quantitative Data and Formulae, 2nd Edition, John Wiley and Sons
%
%     12) Niccoli, M., (2012) - How to assess a color map - in:
%         52 things you should know about Geophysics, M. Hall and E. Bianco,
%         eds.
%
%     13) Niccoli, M., and Lynch, S. (2012, in press) - A more perceptual color
%         palette for structure maps, 2012 CSEG Geoconvention extended
%         abstract.
%
%     14) Color Blind Essentials eBook
%         http://www.colblindor.com/color-blind-essentials/
%
%  Author: Matteo Niccoli
%  e-mail address: matteo@mycarta.ca
%  Release: 3.0
%  Release date: February 2013
%  Full research at:
%  http://mycarta.wordpress.com/2012/05/29/the-rainbow-is-dead-long-live-the-rainbow-series-outline/


% error checking, defaults, valid schemes
error(nargchk(0,2,nargin))
error(nargoutchk(0,1,nargout))

if nargin<2
    scheme = 'CubicYF';
end
if nargin<1
    n = size(get(gcf,'colormap'),1);
end
if n>256
    error('Maximum number of 256 points for colormap exceeded');
end

switch lower(scheme)
    case 'isol'
        baseMap = IsoL;
    case 'cubicl'
        baseMap = CubicL;
    case 'edge'
        baseMap = Edge;
    case 'cubicyf'
        baseMap = CubicYF;
    case 'linlhot'
        baseMap = LinLhot;
    case 'linearl'
        baseMap = LinearL;
    otherwise
        error(['Invalid scheme ' scheme])
end
idx1 = linspace(1,n,size(baseMap,1));
idx2 = 1:1:n;
map = interp1(idx1,baseMap,idx2,'cubic');


function baseMap = Edge
baseMap =    [0 0 0;
    0 0 1;
    0 1 1;
    1 1 1;
    1 1 0;
    1 0 0
    0 0 0];

function baseMap = IsoL
baseMap =   [0.9102    0.2236    0.8997
    0.4027    0.3711    1.0000
    0.0422    0.5904    0.5899
    0.0386    0.6206    0.0201
    0.5441    0.5428    0.0110
    1.0000    0.2288    0.1631];

function baseMap = CubicL
baseMap =  [0.4706         0    0.5216;
    0.5137    0.0527    0.7096;
    0.4942    0.2507    0.8781;
    0.4296    0.3858    0.9922;
    0.3691    0.5172    0.9495;
    0.2963    0.6191    0.8515;
    0.2199    0.7134    0.7225;
    0.2643    0.7836    0.5756;
    0.3094    0.8388    0.4248;
    0.3623    0.8917    0.2858;
    0.5200    0.9210    0.3137;
    0.6800    0.9255    0.3386;
    0.8000    0.9255    0.3529;
    0.8706    0.8549    0.3608;
    0.9514    0.7466    0.3686;
    0.9765    0.5887    0.3569];

function baseMap = CubicYF
baseMap =  [0.5151    0.0482    0.6697
    0.5199    0.1762    0.8083
    0.4884    0.2912    0.9234
    0.4297    0.3855    0.9921
    0.3893    0.4792    0.9775
    0.3337    0.5650    0.9056
    0.2795    0.6419    0.8287
    0.2210    0.7123    0.7258
    0.2468    0.7612    0.6248
    0.2833    0.8125    0.5069
    0.3198    0.8492    0.3956
    0.3602    0.8896    0.2919
    0.4568    0.9136    0.3018
    0.6033    0.9255    0.3295
    0.7066    0.9255    0.3414
    0.8000    0.9255    0.3529];


function baseMap = LinearL
baseMap =  [0.0143	0.0143	0.0143
    0.1413	0.0555	0.1256
    0.1761	0.0911	0.2782
    0.1710	0.1314	0.4540
    0.1074	0.2234	0.4984
    0.0686	0.3044	0.5068
    0.0008	0.3927	0.4267
    0.0000	0.4763	0.3464
    0.0000	0.5565	0.2469
    0.0000	0.6381	0.1638
    0.2167	0.6966	0.0000
    0.3898	0.7563	0.0000
    0.6912	0.7795	0.0000
    0.8548	0.8041	0.4555
    0.9712	0.8429	0.7287
    0.9692	0.9273	0.8961];


function baseMap = LinLhot
baseMap =  [0.0225	0.0121	0.0121
    0.1927	0.0225	0.0311
    0.3243	0.0106	0.0000
    0.4463	0.0000	0.0091
    0.5706	0.0000	0.0737
    0.6969	0.0000	0.1337
    0.8213	0.0000	0.1792
    0.8636	0.0000	0.0565
    0.8821	0.2555	0.0000
    0.8720	0.4182	0.0000
    0.8424	0.5552	0.0000
    0.8031	0.6776	0.0000
    0.7659	0.7870	0.0000
    0.8170	0.8296	0.0000
    0.8853	0.8896	0.4113
    0.9481	0.9486	0.7165];

function c = redbluecmap(m,varargin)
%REDBLUECMAP creates a red and blue colormap.
%
%   REDBLUECMAP(M) returns an M-by-3 matrix containing a red and blue
%   diverging color palette. M is the number of different colors in the
%   colormap with a minimun of 3 and a maximun of 11. Low values are dark
%   blue, values in the center of the map are white, and high values are
%   dark red. If M is empty, a default value of 11 will be used.
%
%   Example:
%
%       % Reset the colormap of the current figure, type
%             colormap(redbluecmap)
%
%   See also CLUSTERGRAM, COLORMAP, COLORMAPEDITOR, REDGREENCMAP.

%   Copyright 2007 The MathWorks, Inc.
%   $Revision: 1.1.6.2.4.1 $  $Date: 2008/01/23 21:09:34 $

% Reference:
% http://colorbrewer.org.

%== Setting default
if nargin < 1 || isempty(m) || ~isnumeric(m)
    m = 11;
end

if ~isscalar(m)
    m = m(:);
end

m = max(abs(fix(m)), 3);
m = min(m, 11);

switch (m)
    case 3
        c = [239	138     98;
            247	247     247;
            103	169     207];
    case 4
        c = [202	0       32;
            244	165     130;
            146	197     222;
            5      113     176];
    case 5
        c = [202	0       32;
            244	165     130;
            247	247     247;
            146	197     222;
            5      113     176];
    case 6
        c = [178	24      43;
            239	138     98;
            253	219     199;
            209	229     240;
            103	169     207;
            33     102     172];
    case 7
        c = [178	24      43;
            239	138     98;
            253	219     199;
            247     247     247;
            209     229     240;
            103     169     207;
            33      102     172];
    case 8
        c = [178	24      43;
            214	96      77;
            244	165     130;
            253	219     199;
            209	229     240;
            146	197     222;
            67     147     195;
            33     102     172];
    case 9
        c = [178	24      43;
            214	96      77;
            244	165     130;
            253	219     199;
            247	247     247;
            209	229     240;
            146	197     222;
            67     147     195;
            33     102     172];
    case 10
        c = [103	0       31;
            178     24      43;
            214     96      77;
            244     165     130;
            253     219     199;
            209     229     240;
            146     197     222;
            67	    147     195;
            33      102     172;
            5       48      97];
    case 11
        c = [103    0       31;
            178     24      43;
            214     96      77;
            244     165     130;
            253     219     199;
            247     247     247;
            209     229     240;
            146     197     222;
            67      147     195;
            33      102     172;
            5       48      97];
end
c = flipud(c/255);
x = round(linspace(1,256,11));
% ----------------------- Piecewise linear interpolation -----------------------
nSegments           = numel(x) - 1;
samplesPerSegment   = diff(x);
colormapOut         = zeros([sum(samplesPerSegment) 3]);

for iSegments = 1:nSegments,
    for iColors = 1:3,
        colormapOut(x(iSegments):x(iSegments+1),iColors) = linspace(c(iSegments,iColors),...
            c(iSegments+1,iColors),...
            samplesPerSegment(iSegments)+1);
    end
end
c = colormapOut;
% ==============================================================================
% [EOF]
